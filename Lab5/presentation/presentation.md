# Лабораторная работа №5

# Что нужно было сделать?

Изучить механизмы изменения идентификаторов, применения SetUID- и Sticky-битов. Получить практические навыки работы в консоли с дополнительными атрибутами. Рассмотреть работы механизма смены идентификатора процессов пользователей, а также влияние бита Sticky на запись и удаление файлов.

# Ход работы

- Вошел в систему от имени пользователя guest:

   ![Вход в систему](image/1.png)

   *Рис. 1. Вход в систему*

# Ход работы

-  Создал файл с кодом программы на языке С:

   ![Создание файла](image/2.1.png)

   *Рис. 2.1. Создание файла*

   ![Код программы](image/2.2.png)

   *Рис. 2.2. Код программы*

# Ход работы

- Скомпилировал программу:

   ![Компиляция](image/3.png)

   *Рис. 3. Компиляция*

# Ход работы
-  Выполнил программу командой ./simpleid:

   ![Результат работы](image/4.png)

   *Рис. 4. Результат работы*

# Ход работы

- Выполнил системную программу id:

   ![Выполнение id](image/5.png)

   *Рис. 5. Выполнение id*

# Ход работы

- Усложнил программу, добавив вывод действительных идентификаторов:

   ![Создание файла](image/6.1.png)

   *Рис. 6.1. Создание файла*

   ![Код программы](image/6.2.png)

   *Рис. 6.2. Код программы*

# Ход работы

- Скомпилировал и запустил:

   ![Компиляция и запуск](image/7.png)

   *Рис. 7. Компиляция и запуск*

# Ход работы
-  От имени суперпользователя выполнил следующие команды:

   ![Изменение атрибутов](image/8.png)

   *Рис. 8. Изменение атрибутов*

# Ход работы

- С помощью команды chown root:guest /home/guest/simpleid2 удалось изменить права на файл с guest на root. Следующая команда позволяет установить атрибут SetUID, при наличии которого программа запускается с правами владельца файла.

# Ход работы

- Выполнил проверку правильности установки прав и атрибутов:

  ![Установка атрибута i на файл file1](image/10.png)

  *Рис. 10. Установка атрибута i на файл file1*

# Ход работы

- Запустил simpleid2 и id:

  ![Запуск simpleid2 и id](image/11.png)

  *Рис. 11. Запуск simpleid2 и id*

# Ход работы

- Проделал то же самое относительно SetGID-бита.

# Ход работы

- Создал программу readfile.c:

  ![Создание файла](image/13.1.png)

  *Рис. 13.1. Создание файла*

  ![Код программы](image/13.2.png)

  *Рис. 13.2. Код программы*

# Ход работы

- Выполнил компиляцию:

  ![Компиляция](image/14.png)

  *Рис. 14. Компиляция*

# Ход работы

- Сменил владельца у файла readfile.c и изменил права так, чтобы только суперпользователь мог прочитать его, а guest не мог:

  ![Смена прав и владельца](image/15.png)

  *Рис. 15. Смена прав и владельца*

# Ход работы

- Проверил, что пользователь guest не может прочитать файл readfile.c:

  ![Установка атрибута i на файл file1](image/16.png)

  *Рис. 16. Установка атрибута i на файл file1*

  При этом программа может прочитать файл readfile.c и /etc/shadow

# Ход работы

- Выяснил, установлен ли атрибут Stucky на директории /tmp, далее от имени пользователя guest создал файл file01.txt со словом test, посмотрел атрибуты этого файла и разрешил чтение и запись для категории пользователей "все остальные", проверил правильность установки атрибутов:

  ![Исследование Sticky-бита](image/17.png)

  *Рис. 17. Исследование Sticky-бита*

# Ход работы

- От пользователя guest2 попробовал прочитать файл (удалось), попробовал дозаписать в файл test2 (удалось перезаписать), снова проверил содержимое и заменил содержимое файла на test3. Все эти операции выполнить удалось, а удалить - не получилось:

  ![Операции над файлом](image/18.png)

  *Рис. 18. Операции над файлом*

# Ход работы

- Повысил права до суперпользователя и снял Sticky-бит с использованием chmod, затем вышел из режима суперпользователя:

  ![Снятие Sticky-бита](image/19.png)

  *Рис. 19. Снятие Sticky-бита*

# Ход работы

- Попробовал снова выполнить вышеописанные операции с файлом file01.txt, на этот раз всё получилось:

  ![Операции над файлом без атрибута t на директории tmp](image/20.png)

  *Рис. 20. Операции над файлом без атрибута t на директории tmp*

# Ход работы

- Повысил права до суперпользователя, вернул атрибут t на директорию:

  ![Возвращение атрибута t на директорию tmp](image/21.png)

  *Рис. 21. Возвращение атрибута t на директорию tmp*

# Вывод

В результате выполнения работы я изучил механизмы изменения идентификаторов, использования SetUID-бита и Sticky-бита, получил практические навыки работы в консоли с дополнительными атрибутами. Рассмотрел работу механизма смены идентификатора процессов пользователей, а также механизм влияния Sticky-бита на возможные операции над файлами внутри директории.

# Спасибо за внимание!